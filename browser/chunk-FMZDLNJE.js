import{$b as V,Aa as f,G as y,Ga as t,Ha as n,Hb as k,Ia as C,J as x,K as d,La as _,Na as M,O as p,P as c,Pb as P,Wb as E,Ya as h,Yb as O,Za as i,ac as I,bc as L,c as z,cb as b,cc as N,db as w,dc as T,eb as v,ja as u,mc as F,pc as j,ra as S,rc as A,tc as R}from"./chunk-I5POFBP6.js";var g=class s{constructor(m){this.http=m}apiUrl="https://localhost:7167/api/Patient/login";onlogin(m){return this.http.post(this.apiUrl,m)}static \u0275fac=function(e){return new(e||s)(x(k))};static \u0275prov=y({token:s,factory:s.\u0275fac,providedIn:"root"})};var q=z(R());var W=class s{user={email:"",password:""};auth=d(g);router=d(P);tokenService=d(E);onlogin(){if(console.log("\u{1F680} Sending login request...",this.user),!(localStorage.getItem("otpVerified")==="true")){q.default.fire({icon:"warning",title:"\u26A0\uFE0F OTP Verification Required",text:"You must verify your OTP before logging in.",confirmButtonText:"OK"}).then(e=>{e.isConfirmed&&this.router.navigate(["/verify-otp"])});return}this.auth.onlogin(this.user).subscribe({next:e=>{console.log("\u2705 Response:",e),e.token?(localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify({id:e.patient.pid,name:e.patient.pname,phone:e.patient.pphone,email:e.patient.pemail})),localStorage.setItem("username",e.patient.pname),console.log("\u{1F511} Token Saved!"),this.tokenService.setUsername(e.patient.pname),this.router.navigate(["/"])):console.warn("\u26A0\uFE0F No token received, check API response.")},error:e=>{console.error("\u274C Login Error:",e),console.error("\u{1F4CC} Error Status:",e.status),console.error("\u{1F4CC} Error Message:",e.message),console.error("\u{1F4CC} Full Error:",e)}})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=S({type:s,selectors:[["app-login"]],decls:35,vars:10,consts:[["loginForm","ngForm"],["emailInput","ngModel"],["passwordInput","ngModel"],[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"card","shadow-sm",2,"width","350px"],[1,"card-header","bg-primary","text-white","text-center","py-2"],[1,"mb-0"],[1,"card-body"],["novalidate","",3,"ngSubmit"],[1,"mb-3"],["for","email",1,"form-label"],["type","text","id","email","name","email","required","","pattern","^([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,6}|01[0-2|5]{1}[0-9]{8})$",1,"form-control",3,"ngModelChange","ngModel"],[1,"invalid-feedback"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","","pattern","^(?=.*[a-z])(?=.*[A-Z]).{6,}$",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-danger","w-100","mb-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"form-check"],["type","checkbox","id","remember",1,"form-check-input"],["for","remember",1,"form-check-label","fw-bold"],["href","#",1,"text-success","fw-bold","text-decoration-none"],[1,"text-center","mt-2"],["href","/signup",1,"signup-link","fw-bold","text-primary"]],template:function(e,r){if(e&1){let o=_();t(0,"div",3)(1,"div",4)(2,"div",5)(3,"h5",6),i(4,"Login"),n()(),t(5,"div",7)(6,"form",8,0),M("ngSubmit",function(){return p(o),c(r.onlogin())}),t(8,"div",9)(9,"label",10),i(10,"Email *"),n(),t(11,"input",11,1),v("ngModelChange",function(l){return p(o),w(r.user.email,l)||(r.user.email=l),c(l)}),n(),t(13,"div",12),i(14," Please enter a valid email or mobile number & Only English characters are allowed. "),n()(),t(15,"div",9)(16,"label",13),i(17,"Password *"),n(),t(18,"input",14,2),v("ngModelChange",function(l){return p(o),w(r.user.password,l)||(r.user.password=l),c(l)}),n(),t(20,"div",12),i(21," Password must be at least 6 characters and include uppercase & lowercase letters. "),n()(),t(22,"button",15),i(23,"LOGIN"),n(),t(24,"div",16)(25,"div",17),C(26,"input",18),t(27,"label",19),i(28,"Remember me"),n()(),t(29,"a",20),i(30,"Forgot Password?"),n()()(),t(31,"p",21),i(32," New User? "),t(33,"a",22),i(34,"Sign Up"),n()()()()()}if(e&2){let o=h(12),a=h(19);u(11),f("is-invalid",o.invalid&&o.touched)("is-valid",o.valid&&o.touched),b("ngModel",r.user.email),u(7),f("is-invalid",a.invalid&&a.touched)("is-valid",a.valid&&a.touched),b("ngModel",r.user.password)}},dependencies:[A,T,O,V,I,F,j,N,L],styles:['body[_ngcontent-%COMP%]{background-color:#f8f9fa}.container_card[_ngcontent-%COMP%]{margin:50px auto}.or-circle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background-color:#fff;border:2px solid #ccc;display:flex;align-items:center;justify-content:center;font-weight:700;color:#555;margin:0 10px}.login-container[_ngcontent-%COMP%]{margin-top:50%;padding:20px;width:350px}.form-check-label[_ngcontent-%COMP%], .text-danger.fw-bold[_ngcontent-%COMP%]{font-size:.85rem;text-decoration:none}.signup-link[_ngcontent-%COMP%]{color:#00f;text-decoration:none;position:relative;padding-bottom:3px;padding-left:15px}.signup-link[_ngcontent-%COMP%]:after{content:"";position:absolute;left:10px;bottom:0;width:100%;height:2px;background-color:red}']})};export{W as LoginComponent};
